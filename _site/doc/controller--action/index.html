
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>
      
        Controller & Action - 
      
      Goku
    </title>
    <meta name="description" content="">
    <meta name="author" content="QLeelulu">

    <link rel="stylesheet" href="/assets/themes/modernist/stylesheets/styles.css">
    <link rel="stylesheet" href="/assets/themes/modernist/stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>

  <div class="outer">
    <div class="sidebar">
      <ul class="posts">
        <li><a href="/">About</a></li>
        <li><a href="/doc/intro">Intro</a></li>
        <li><a href="/doc/router">Router</a></li>
        <li><a href="/doc/controller--action">Controller & Action</a></li>
        <li><a href="/doc/view">View & ViewEngine</a></li>
        <li><a href="/doc/template">Template</a></li>
        <li><a href="/doc/form-validation">Form Validation</a></li>
        <li><a href="/doc/filter">Filter</a></li>
        <li><a href="/doc/middleware">Middleware</a></li>
        <li><a href="/doc/db">DB</a></li>
        <li><a href="/doc/httpcontext">HttpContext</a></li>
        <li><a href="/doc/log">Log</a></li>
      </ul>
    </div>

    <div class="wrapper">
      <header>
        <h1><a class="brand" href="/">Goku</a></h1>
        <p>Golang Web Mvc Framework</p>
        <p class="view"><a href="http://github.com/qleelulu/goku">View the Project on GitHub <small>qleelulu/goku</small></a></p>
        <ul>
          <li><a href="https://github.com/qleelulu/goku/zipballmus/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/qleelulu/goku/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="http://github.com/qleelulu/goku">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        
  <h1>
    Controller & Action 
    
  </h1>

<p>Goku maps URLs to controllers that regiest to goku server. Controllers process incoming requests, handle user input and interactions, and execute appropriate application logic. A controller typically calls a separate view component to generate the HTML markup for the request.</p>

<h2 id='controllerbuilder'>ControllerBuilder</h2>

<p>We build controller with <a href='http://go.pkgdoc.org/github.com/QLeelulu/goku#ControllerBuilder'>ControllerBuilder</a></p>
<div class='highlight'><pre><code class='go'><span class='c1'>// a home controller builder</span>
<span class='kd'>var</span> <span class='nx'>cb</span> <span class='o'>*</span><span class='nx'>goku</span><span class='p'>.</span><span class='nx'>ControllerBuilder</span> <span class='p'>=</span> <span class='nx'>goku</span><span class='p'>.</span><span class='nx'>Controller</span><span class='p'>(</span><span class='s'>&quot;home&quot;</span><span class='p'>)</span>
<span class='c1'>// add a &quot;index&quot; action to &quot;home&quot; controller for http get</span>
<span class='nx'>cb</span><span class='p'>.</span><span class='nx'>Get</span><span class='p'>(</span><span class='s'>&quot;index&quot;</span><span class='p'>,</span> <span class='kd'>func</span><span class='p'>(</span><span class='nx'>ctx</span> <span class='o'>*</span><span class='nx'>goku</span><span class='p'>.</span><span class='nx'>HttpContext</span><span class='p'>)</span> <span class='nx'>goku</span><span class='p'>.</span><span class='nx'>ActionResulter</span> <span class='p'>{</span>
    <span class='k'>return</span> <span class='nx'>ctx</span><span class='p'>.</span><span class='nx'>Html</span><span class='p'>(</span><span class='s'>&quot;Hello World&quot;</span><span class='p'>)</span>
<span class='p'>})</span>
</code></pre></div>
<p>Use <code>goku.Controller(&quot;controller-name&quot;)</code> to get a controller builder. If the controller <code>&quot;controller-name&quot;</code> exist, it will just return the same controller builder.</p>

<h2 id='action'>Action</h2>

<p>User interaction with goku MVC applications is organized around controllers and action methods. The controller defines action methods. Controllers can include as many action methods as needed.</p>

<p>When a user enters a URL into the browser, the MVC application uses routing rules to parse the URL and to determine the path of the controller. The controller then determines the appropriate action method to handle the request. By default, the URL of a request is treated as a sub-path that includes the controller name followed by the action name. For example, if a user enters the URL <code>http://abc.com/Products/Categories</code>, the sub-path is <code>/Products/Categories</code>. The default routing rule treats &#8220;Products&#8221; as the controller. It treats &#8220;Categories&#8221; as the name of the action. Therefore, the routing rule invokes the Categories action of the Products controller in order to process the request. If the URL ends with <code>/Products/Detail/5</code>, the default routing rule treats <code>&quot;Detail&quot;</code> as the name of the action, and the Detail action of the Products controller is invoked to process the request.</p>

<p>The following example shows a controller that has a <code>HelloWorld</code> action for http GET method.</p>
<div class='highlight'><pre><code class='go'><span class='kd'>var</span> <span class='nx'>_</span> <span class='p'>=</span> <span class='nx'>goku</span><span class='p'>.</span><span class='nx'>Controller</span><span class='p'>(</span><span class='s'>&quot;my&quot;</span><span class='p'>).</span>
    <span class='nx'>Action</span><span class='p'>(</span><span class='s'>&quot;get&quot;</span><span class='p'>,</span> <span class='s'>&quot;HelloWorld&quot;</span><span class='p'>,</span> <span class='kd'>func</span><span class='p'>(</span><span class='nx'>ctx</span> <span class='o'>*</span><span class='nx'>goku</span><span class='p'>.</span><span class='nx'>HttpContext</span><span class='p'>)</span> <span class='nx'>goku</span><span class='p'>.</span><span class='nx'>ActionResulter</span> <span class='p'>{</span>
        <span class='k'>return</span> <span class='nx'>ctx</span><span class='p'>.</span><span class='nx'>Html</span><span class='p'>(</span><span class='s'>&quot;Hello World&quot;</span><span class='p'>)</span>
    <span class='p'>})</span>
</code></pre></div>
<p><a href='http://go.pkgdoc.org/github.com/QLeelulu/goku#ControllerBuilder'>ControllerBuilder</a> has some helper method: <code>Get</code>, <code>Post</code>, <code>Put</code>. So you can do it the same by this code:</p>
<div class='highlight'><pre><code class='go'><span class='kd'>var</span> <span class='nx'>_</span> <span class='p'>=</span> <span class='nx'>goku</span><span class='p'>.</span><span class='nx'>Controller</span><span class='p'>(</span><span class='s'>&quot;my&quot;</span><span class='p'>).</span>
    <span class='nx'>Get</span><span class='p'>(</span><span class='s'>&quot;HelloWorld&quot;</span><span class='p'>,</span> <span class='kd'>func</span><span class='p'>(</span><span class='nx'>ctx</span> <span class='o'>*</span><span class='nx'>goku</span><span class='p'>.</span><span class='nx'>HttpContext</span><span class='p'>)</span> <span class='nx'>goku</span><span class='p'>.</span><span class='nx'>ActionResulter</span> <span class='p'>{</span>
        <span class='k'>return</span> <span class='nx'>ctx</span><span class='p'>.</span><span class='nx'>Html</span><span class='p'>(</span><span class='s'>&quot;Hello World&quot;</span><span class='p'>)</span>
    <span class='p'>})</span>
</code></pre></div>
<p>If you set http method to <code>all</code>, the action will match all http method, but Priority is low. <br />For example:</p>
<div class='highlight'><pre><code class='go'><span class='kd'>var</span> <span class='nx'>_</span> <span class='p'>=</span> <span class='nx'>goku</span><span class='p'>.</span><span class='nx'>Controller</span><span class='p'>(</span><span class='s'>&quot;user&quot;</span><span class='p'>).</span>
    <span class='c1'>// action 1</span>
    <span class='nx'>Post</span><span class='p'>(</span><span class='s'>&quot;edit&quot;</span><span class='p'>,</span> <span class='kd'>func</span><span class='p'>(</span><span class='nx'>ctx</span> <span class='o'>*</span><span class='nx'>goku</span><span class='p'>.</span><span class='nx'>HttpContext</span><span class='p'>)</span> <span class='nx'>goku</span><span class='p'>.</span><span class='nx'>ActionResulter</span> <span class='p'>{</span>
        <span class='k'>return</span> <span class='nx'>ctx</span><span class='p'>.</span><span class='nx'>View</span><span class='p'>(</span><span class='kc'>nil</span><span class='p'>)</span>
    <span class='p'>}).</span>
    <span class='c1'>// action 2</span>
    <span class='nx'>Action</span><span class='p'>(</span><span class='s'>&quot;all&quot;</span><span class='p'>,</span> <span class='s'>&quot;edit&quot;</span><span class='p'>,</span> <span class='kd'>func</span><span class='p'>(</span><span class='nx'>ctx</span> <span class='o'>*</span><span class='nx'>goku</span><span class='p'>.</span><span class='nx'>HttpContext</span><span class='p'>)</span> <span class='nx'>goku</span><span class='p'>.</span><span class='nx'>ActionResulter</span> <span class='p'>{</span>
        <span class='k'>return</span> <span class='nx'>ctx</span><span class='p'>.</span><span class='nx'>View</span><span class='p'>(</span><span class='kc'>nil</span><span class='p'>)</span>
    <span class='p'>})</span>
</code></pre></div>
<p>A <code>Http POST /user/edit</code> request will process by <code>Post(&quot;edit&quot;, ...)</code>, <br />but a <code>Http GET /user/edit</code> request will process by <code>Action(&quot;all&quot;, &quot;edit&quot;, ...)</code>.</p>

<h2 id='actionresult_return_type'>ActionResult Return Type</h2>

<p>Action methods return an instance of a struct that implement the <a href='http://go.pkgdoc.org/github.com/QLeelulu/goku#ActionResulter'>ActionResulter</a> interface. There are different action result types, depending on the task that the action method is performing. For example, the most common action is to call the <code>HttpContext.View</code> method. The View method returns an instance of the ViewResult struct, which is implement the ActionResulter interface.</p>

<p>The following table shows the built-in action result types and the action helper methods that return them.</p>
<table><thead><tr><th>Action Result</th><th>Helper Method</th><th>Description</th></tr></thead><tbody><tr><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#ViewResult'>ViewResult</a></td><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#HttpContext.View'>ctx.View</a></td><td style='text-align: left;'>Renders a view as a Web page.</td>
</tr><tr><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#ViewResult'>ViewResult</a></td><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#HttpContext.RenderPartial'>ctx.RenderPartial</a></td><td style='text-align: left;'>Renders a partial view, mean that not render the layout.</td>
</tr><tr><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#ActionResulter'>ActionResulter</a></td><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#HttpContext.Redirect'>ctx.Redirect</a></td><td style='text-align: left;'>Redirects to another action method by using its URL.(<code>302</code>)</td>
</tr><tr><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#ActionResulter'>ActionResulter</a></td><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#HttpContext.RedirectPermanent'>ctx.RedirectPermanent</a></td><td style='text-align: left;'>Redirects to another action method by using its URL.(<code>301</code>)</td>
</tr><tr><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#ContentResult'>ContentResult</a></td><td style='text-align: left;'>No</td><td style='text-align: left;'>Returns binary output to write to the response.</td>
</tr><tr><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#ActionResulter'>ActionResulter</a></td><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#HttpContext.Json'>ctx.Json</a></td><td style='text-align: left;'>Returns a serialized JSON object.</td>
</tr><tr><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#ActionResulter'>ActionResulter</a></td><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#HttpContext.Html'>ctx.Html</a></td><td style='text-align: left;'>Returns string content, but set response Content-Type to text/html .</td>
</tr><tr><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#ActionResulter'>ActionResulter</a></td><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#HttpContext.Raw'>ctx.Raw</a></td><td style='text-align: left;'>Returns string content, but set response Content-Type to text/plain .</td>
</tr><tr><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#ActionResulter'>ActionResulter</a></td><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#HttpContext.NotModified'>ctx.NotModified</a></td><td style='text-align: left;'>Returns 304 not modified .</td>
</tr><tr><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#ActionResulter'>ActionResulter</a></td><td style='text-align: left;'><a href='http://godoc.org/github.com/QLeelulu/goku#HttpContext.NotFound'>ctx.NotFound</a></td><td style='text-align: left;'>Returns 404 page not found .</td>
</tr></tbody></table>
<h2 id='custom_actionresult'>Custom ActionResult</h2>

<p>To implement your own action result, you just need to implement the <a href='http://godoc.org/github.com/QLeelulu/goku#ActionResulter'>ActionResulter</a> interface, and return it in the action.</p>


      </section>
    </div>

  </div>

    <footer>
      <p>Project maintained by <a href="https://www.github.com/QLeelulu">QLeelulu</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <script src="/assets/themes/modernist/javascripts/scale.fix.js"></script>
  </body>
</html>
